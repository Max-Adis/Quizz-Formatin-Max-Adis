<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Pack DÃ©couverte | Max Adis</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #00d2ff; --secondary: #3a7bd5; --success: #2ecc71; --error: #e74c3c; --bg: #f4f7f6;
        }
        body { font-family: 'Poppins', sans-serif; background: linear-gradient(135deg, var(--primary), var(--secondary)); min-height: 100vh; margin: 0; display: flex; justify-content: center; align-items: center; padding: 15px; }
        .quiz-container { background: white; width: 100%; max-width: 600px; padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        
        /* Barre de progression */
        .progress-container { width: 100%; height: 8px; background: #eee; border-radius: 10px; margin-bottom: 25px; overflow: hidden; }
        .progress-bar { height: 100%; background: var(--primary); width: 0%; transition: 0.4s; }
        .step-text { font-size: 14px; color: #7f8c8d; font-weight: 600; margin-bottom: 10px; display: block; }

        h2 { font-size: 20px; color: #2c3e50; margin-bottom: 20px; }
        .options { display: flex; flex-direction: column; gap: 10px; }
        .option-btn { padding: 15px; border: 2px solid #edf2f7; border-radius: 12px; cursor: pointer; transition: 0.2s; background: white; text-align: left; font-size: 15px; }
        .option-btn:hover { border-color: var(--primary); background: #f0fbff; }
        .option-btn.selected { border-color: var(--secondary); background: #e0f4ff; font-weight: 600; }

        .hidden { display: none; }
        button#next-btn, button#submit-btn { width: 100%; margin-top: 25px; padding: 15px; background: var(--secondary); color: white; border: none; border-radius: 10px; cursor: pointer; font-size: 16px; font-weight: 600; }
        
        /* Styles de la liste finale */
        .result-item { padding: 15px; border-radius: 10px; margin-bottom: 10px; border-left: 5px solid; }
        .res-correct { background: #d4edda; border-color: var(--success); color: #155724; }
        .res-wrong { background: #f8d7da; border-color: var(--error); color: #721c24; }
        .correction { font-size: 13px; display: block; margin-top: 5px; font-weight: 600; }
    </style>
</head>
<body>

<div class="quiz-container">
    <div id="intro-screen">
        <h1 style="text-align: center;">ðŸš€ Quiz Final</h1>
        <p style="text-align: center; color: #666;">Entrez vos informations pour commencer la validation du Pack DÃ©couverte.</p>
        <input type="text" id="user-name" placeholder="Nom et PrÃ©nom" style="width: 100%; padding: 12px; margin-bottom: 15px; border-radius: 8px; border: 1px solid #ccc; box-sizing: border-box;">
        <input type="email" id="user-email" placeholder="Votre Email" style="width: 100%; padding: 12px; margin-bottom: 20px; border-radius: 8px; border: 1px solid #ccc; box-sizing: border-box;">
        <button onclick="startQuiz()">Commencer le Quiz</button>
    </div>

    <div id="quiz-screen" class="hidden">
        <span class="step-text" id="step-counter">Question 1/10</span>
        <div class="progress-container"><div class="progress-bar" id="progress-bar"></div></div>
        
        <h2 id="question-text">Chargement de la question...</h2>
        <div class="options" id="options-container"></div>
        <button id="next-btn" onclick="nextQuestion()">Question suivante</button>
    </div>

    <div id="result-screen" class="hidden">
        <h2 style="text-align: center;">Fin du Module ! ðŸŽ‰</h2>
        <div id="score-display" style="text-align: center; font-size: 24px; font-weight: bold; margin-bottom: 20px;"></div>
        <div id="final-list"></div>
        <p style="text-align: center; font-size: 12px; color: #888; margin-top: 20px;">Vos rÃ©sultats ont Ã©tÃ© envoyÃ©s Ã  Max Adis.</p>
    </div>
</div>

<script>
    const questions = [
        { q: "Quâ€™est-ce quâ€™une carte Arduino ?", options: ["Un support de LED", "Un petit ordinateur (microcontrÃ´leur)", "Une batterie"], ans: 1 },
        { q: "Quel domaine n'est PAS citÃ© ?", options: ["Robotique", "Domotique", "ComptabilitÃ©"], ans: 2 },
        { q: "Pourquoi choisir Arduino ?", options: ["Abordable et grande communautÃ©", "C'est trÃ¨s cher", "Pas besoin de code"], ans: 0 },
        { q: "La rÃ©fÃ©rence du Pack est :", options: ["Arduino MEGA", "Arduino UNO", "ESP32"], ans: 1 },
        { q: "L'Arduino MEGA est idÃ©al pour :", options: ["Projets simples", "Projets complexes", "Remplacer une pile"], ans: 1 },
        { q: "UtilitÃ© de la Breadboard :", options: ["Souder", "Programmer", "Tester sans soudure"], ans: 2 },
        { q: "La grande breadboard possÃ¨de :", options: ["170 points", "830 points", "400 points"], ans: 1 },
        { q: "Le bouton 'TÃ©lÃ©verser' sert Ã  :", options: ["Envoyer le code Ã  la carte", "Eteindre la carte", "Effacer"], ans: 0 },
        { q: "RÃ´le de la rÃ©sistance :", options: ["Augmenter le courant", "Limiter le courant (protection)", "Changer la couleur"], ans: 1 },
        { q: "delay(1000) signifie :", options: ["Attendre 10s", "Attendre 1 seconde", "Vitesse max"], ans: 1 }
    ];

    let currentIdx = 0;
    let score = 0;
    let userAnswers = [];
    let userName = "";
    let userEmail = "";

    function startQuiz() {
        userName = document.getElementById('user-name').value;
        userEmail = document.getElementById('user-email').value;
        if(!userName || !userEmail) return alert("Veuillez remplir vos infos");
        
        document.getElementById('intro-screen').classList.add('hidden');
        document.getElementById('quiz-screen').classList.remove('hidden');
        showQuestion();
    }

    function showQuestion() {
        const q = questions[currentIdx];
        document.getElementById('question-text').innerText = q.q;
        document.getElementById('step-counter').innerText = `Question ${currentIdx + 1}/${questions.length}`;
        document.getElementById('progress-bar').style.width = ((currentIdx + 1) / questions.length * 100) + "%";
        
        const container = document.getElementById('options-container');
        container.innerHTML = "";
        q.options.forEach((opt, i) => {
            const btn = document.createElement('div');
            btn.className = "option-btn";
            btn.innerText = opt;
            btn.onclick = () => selectOption(i, btn);
            container.appendChild(btn);
        });
        document.getElementById('next-btn').innerText = currentIdx === questions.length - 1 ? "Finaliser et Envoyer" : "Question suivante";
    }

    let selectedOption = null;
    function selectOption(index, btn) {
        selectedOption = index;
        document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
    }

    function nextQuestion() {
        if(selectedOption === null) return alert("Choisissez une rÃ©ponse !");
        
        userAnswers.push(selectedOption);
        if(selectedOption === questions[currentIdx].ans) score++;
        
        if(currentIdx < questions.length - 1) {
            currentIdx++;
            selectedOption = null;
            showQuestion();
        } else {
            sendResults();
        }
    }

    function sendResults() {
        // Envoi vers Formspree
        const formData = new FormData();
        formData.append("Nom", userName);
        formData.append("Email", userEmail);
        formData.append("Score Final", score + "/10");
        
        fetch("https://formspree.io/f/mrebnnlk", {
            method: "POST",
            body: formData,
            headers: { 'Accept': 'application/json' }
        }).then(() => {
            showFinalScreen();
        });
    }

    function showFinalScreen() {
        document.getElementById('quiz-screen').classList.add('hidden');
        document.getElementById('result-screen').classList.remove('hidden');
        
        const scoreDisplay = document.getElementById('score-display');
        scoreDisplay.innerText = `Votre Score : ${score} / ${questions.length}`;
        scoreDisplay.style.color = score >= 7 ? "var(--success)" : "var(--error)";

        const listContainer = document.getElementById('final-list');
        questions.forEach((q, i) => {
            const isCorrect = userAnswers[i] === q.ans;
            const div = document.createElement('div');
            div.className = `result-item ${isCorrect ? 'res-correct' : 'res-wrong'}`;
            div.innerHTML = `
                <strong>${i+1}. ${q.q}</strong><br>
                Votre rÃ©ponse : ${q.options[userAnswers[i]]}
                ${!isCorrect ? `<span class="correction">Correction : ${q.options[q.ans]}</span>` : ''}
            `;
            listContainer.appendChild(div);
        });
    }
</script>

</body>
</html>
